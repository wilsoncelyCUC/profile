---
import { getCollection } from 'astro:content';
import CaseStudyCard from '../ui/CaseStudyCard.astro';

const caseStudies = await getCollection('case-studies');
const sortedCaseStudies = caseStudies
  .filter((cs) => cs.data.featured)
  .sort((a, b) => a.data.order - b.data.order);
---

<section id="proof" class="py-24 bg-white">
  <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
    <h2 class="text-3xl sm:text-4xl font-black text-brand-gray text-center mb-4">
      Proof
    </h2>
    <p class="text-xl text-brand-gray/70 text-center mb-16 max-w-2xl mx-auto">
      Real outcomes from real engagements
    </p>

    {sortedCaseStudies.length > 0 ? (
      <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
        {sortedCaseStudies.map((caseStudy, index) => (
          <CaseStudyCard caseStudy={caseStudy.data} delay={index * 150} />
        ))}
      </div>
    ) : (
      <div
        x-data="{ visible: false }"
        x-intersect:enter="visible = true"
        :class="{ 'opacity-100 translate-y-0': visible, 'opacity-0 translate-y-8': !visible }"
        class="text-center py-12 bg-brand-bg rounded-lg transition-all duration-700"
      >
        <p class="text-brand-gray/60 text-lg">Case studies coming soon.</p>
        <p class="text-brand-gray/50 mt-2">
          Contact me to discuss how I've helped similar organizations.
        </p>
      </div>
    )}
  </div>
</section>
